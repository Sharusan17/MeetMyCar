{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sharusan/MeetMyCar/myapp/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/sharusan/MeetMyCar/myapp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/sharusan/MeetMyCar/myapp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{useAuth}from'./AuthContext';import{useLocation,useNavigate}from'react-router-dom';import'./VerifyEmail_css.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var VerifyEmail=function VerifyEmail(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),verified=_useState2[0],setVerified=_useState2[1];var _useAuth=useAuth(),currentUser=_useAuth.currentUser,logout=_useAuth.logout;var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),message=_useState4[0],setMessage=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),emailSent=_useState8[0],setEmailSent=_useState8[1];var navigate=useNavigate();var location=useLocation();// Check in interval, if the email has been verified\nuseEffect(function(){var checkVerified=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var newEmail;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:// fetches email address from previous page, to check if been verified\nnewEmail=new URLSearchParams(location.search).get('newEmail');_context.prev=1;console.log(\"Checking Verification...\");//checks if email has been changed\n_context.next=5;return currentUser.reload();case 5:if(!newEmail){_context.next=16;break;}console.log(\"New Email Being Verified...\");if(!newEmail.emailVerified){_context.next=14;break;}// login to account, if email has been verified\nconsole.log(\"New Email Verified\");setVerified(true);clearInterval(intervalId);_context.next=13;return logout();case 13:navigate('/login');case 14:_context.next=20;break;case 16:_context.next=18;return currentUser.reload();case 18:console.log(\"Email Being Verified...\");if(currentUser.emailVerified){// navigate to registervehicle, if email has been verified for new users\nconsole.log(\"Email Being Verified\");setVerified(true);clearInterval(intervalId);navigate(\"/registervehicle\");}case 20:_context.next=26;break;case 22:_context.prev=22;_context.t0=_context[\"catch\"](1);setError(_context.t0);console.log('Error checking email verification status',_context.t0);case 26:case\"end\":return _context.stop();}},_callee,null,[[1,22]]);}));return function checkVerified(){return _ref.apply(this,arguments);};}();// checks every second, if email is verified\nvar intervalId=setInterval(checkVerified,1000);return function(){return clearInterval(intervalId);};},[currentUser,location.search,navigate,logout]);// handles resend email verification\nvar resendEmail=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:setError('');setMessage('');setEmailSent(true);_context2.prev=3;_context2.next=6;return currentUser.sendEmailVerification();case 6:setMessage(\"Verification Email Sent\");setEmailSent(false);_context2.next=15;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](3);// displays error message, depending on type of error\nsetEmailSent(false);if(_context2.t0.code==='auth/too-many-requests'){setError(\"Try Again Later. Too Many Request\");}else{setError(\"Failed To Send Verification Email\");}console.log(\"Error Sending Verification Email\",_context2.t0);case 15:case\"end\":return _context2.stop();}},_callee2,null,[[3,10]]);}));return function resendEmail(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"Card\",children:[/*#__PURE__*/_jsx(\"header\",{children:/*#__PURE__*/_jsx(\"h1\",{id:\"login_text\",children:\"Verify Email\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"center_H\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"w-100 text-center mt-3 mb-1\",id:\"success_Msg\",children:message}),verified?/*#__PURE__*/_jsx(\"p\",{className:\"verify_text\",children:\"Email Verified Reloading....\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"verify_text\",children:\"Check Inbox For Verification Email\"}),/*#__PURE__*/_jsx(\"div\",{className:\"center\",children:/*#__PURE__*/_jsx(\"button\",{id:\"verifybtn\",onClick:resendEmail,disabled:emailSent,children:emailSent?'Email Sending...':'Resend Verification Email'})})]}),/*#__PURE__*/_jsx(\"p\",{className:\"w-100 text-center mt-3 mb-1\",id:\"error_Msg\",children:error})]})]})});};export default VerifyEmail;","map":{"version":3,"names":["React","useEffect","useState","useAuth","useLocation","useNavigate","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","VerifyEmail","_useState","_useState2","_slicedToArray","verified","setVerified","_useAuth","currentUser","logout","_useState3","_useState4","message","setMessage","_useState5","_useState6","error","setError","_useState7","_useState8","emailSent","setEmailSent","navigate","location","checkVerified","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","newEmail","wrap","_callee$","_context","prev","next","URLSearchParams","search","get","console","log","reload","emailVerified","clearInterval","intervalId","t0","stop","apply","arguments","setInterval","resendEmail","_ref2","_callee2","_callee2$","_context2","sendEmailVerification","code","children","className","id","onClick","disabled"],"sources":["/Users/sharusan/MeetMyCar/myapp/src/VerifyEmail.js"],"sourcesContent":["import React, {useEffect, useState} from 'react'\nimport { useAuth } from './AuthContext'\nimport {useLocation, useNavigate} from 'react-router-dom'\n\nimport './VerifyEmail_css.css'\n\nconst VerifyEmail = () => {\n\n    const [verified, setVerified] = useState(false)\n    const {currentUser, logout} = useAuth()\n\n    const [message, setMessage] = useState('')\n    const [error, setError] = useState('')\n    const [emailSent, setEmailSent] = useState(false)\n\n    const navigate = useNavigate()\n    const location = useLocation()\n\n\n    // Check in interval, if the email has been verified\n    useEffect(() => {\n        const checkVerified = async () => {\n            // fetches email address from previous page, to check if been verified\n            const newEmail = new URLSearchParams(location.search).get('newEmail')\n            try{\n                console.log(\"Checking Verification...\")\n                //checks if email has been changed\n                await currentUser.reload();\n                if (newEmail){\n                    console.log(\"New Email Being Verified...\")\n                    if(newEmail.emailVerified){\n                        // login to account, if email has been verified\n                        console.log(\"New Email Verified\")\n                        setVerified(true)\n                        clearInterval(intervalId)\n                        await logout()\n                        navigate('/login')\n                    }\n                } else{\n                    await currentUser.reload();\n                    console.log(\"Email Being Verified...\")\n                    if (currentUser.emailVerified ){\n                        // navigate to registervehicle, if email has been verified for new users\n                        console.log(\"Email Being Verified\")\n                        setVerified(true)\n                        clearInterval(intervalId)\n                        navigate(\"/registervehicle\")\n                    }\n                }\n            }catch (error) {\n                setError(error)\n                console.log('Error checking email verification status', error)\n            }\n        }\n        // checks every second, if email is verified\n        const intervalId = setInterval(checkVerified, 1000)\n        return () => clearInterval(intervalId)\n    }, [currentUser, location.search, navigate, logout]); \n\n    // handles resend email verification\n    const resendEmail = async() => {\n        setError('')\n        setMessage('')\n        setEmailSent(true)\n        try{ \n            await currentUser.sendEmailVerification();\n            setMessage(\"Verification Email Sent\")\n            setEmailSent(false)\n        }catch (error){\n            // displays error message, depending on type of error\n            setEmailSent(false)\n            if (error.code === 'auth/too-many-requests'){\n                setError(\"Try Again Later. Too Many Request\")\n            }else{\n                setError(\"Failed To Send Verification Email\")\n            }\n            console.log(\"Error Sending Verification Email\", error)\n        }\n    }\n\n  return (\n      <>\n            <div className=\"Card\">\n                <header>\n                    <h1 id=\"login_text\">\n                        Verify Email\n                    </h1>\n                </header>  \n\n                {/* display message depending email is verified or not */}\n                <div className='center_H'>\n                    <p className=\"w-100 text-center mt-3 mb-1\" id=\"success_Msg\">{message}</p>\n                    {verified \n                        ? (\n                            <p className='verify_text'>Email Verified Reloading....</p>\n                        ):(\n                        <>\n                            <p className='verify_text'>Check Inbox For Verification Email</p>\n                            <div className='center'>\n                                {/* resend email verification button */}\n                                <button id=\"verifybtn\" onClick={resendEmail} disabled={emailSent}>\n                                    {emailSent ? 'Email Sending...' : 'Resend Verification Email'}\n                                </button>\n                            </div>\n                        </>\n                    )}\n                    <p className=\"w-100 text-center mt-3 mb-1\" id=\"error_Msg\">{error}</p>\n                </div>                 \n            </div>\n        \n      </> \n  )\n}\n\nexport default VerifyEmail"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}